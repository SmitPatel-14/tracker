<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>21 Day Focus Tracker</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="gicon.png">
</head>
<body>
  <div class="app">
    <img src="gicon.png" alt="Goal Icon" class="goal-icon">
    <h1>21 Day Focus Tracker</h1>
    <div class="quote" id="quote"></div>

    <table class="tracker-table">
      <thead>
        <tr>
          <th class="sticky-col">Day</th>
          <th>Wake Up Early</th>
          <th>Workout</th>
          <th>Read Book</th>
          <th>Less Social Media</th>
          <th>No PM</th>
        </tr>
      </thead>
      <tbody id="tracker-body"></tbody>
    </table>

    <div class="report" id="progressReport"></div>
  </div>

  <script>
    const goals = ['wakeup', 'workout', 'read', 'lesssm', 'nopm'];
    const tbody = document.getElementById("tracker-body");
    const reportBox = document.getElementById("progressReport");

    function updateProgressReport() {
      let completeDays = 0;

      for (let i = 1; i <= 21; i++) {
        let allChecked = true;
        for (const goal of goals) {
          const id = `day${i}_${goal}`;
          if (localStorage.getItem(id) !== 'true') {
            allChecked = false;
            break;
          }
        }
        if (allChecked) completeDays++;
      }

      let message = `<strong>Progress:</strong> ${completeDays} / 21 days fully completed.`;
      if (completeDays === 21) {
        message += `<br><span class="reward">ðŸŽ‰ Youâ€™ve completed all 21 days! Stay disciplined!</span>`;
      }
      reportBox.innerHTML = message;
    }

    for (let i = 1; i <= 21; i++) {
      const row = document.createElement("tr");
      let rowHTML = `<td class="sticky-col">Day ${i}</td>`;
      goals.forEach(goal => {
        const id = `day${i}_${goal}`;
        const checked = localStorage.getItem(id) === 'true' ? 'checked' : '';
        rowHTML += `<td><input type="checkbox" id="${id}" ${checked}></td>`;
      });
      row.innerHTML = rowHTML;
      tbody.appendChild(row);
    }

    goals.forEach(goal => {
      for (let i = 1; i <= 21; i++) {
        const id = `day${i}_${goal}`;
        document.getElementById(id).addEventListener('change', (e) => {
          localStorage.setItem(id, e.target.checked);
          updateProgressReport();
        });
      }
    });

    const quotes = [
      "Discipline is the bridge between goals and accomplishment.",
      "Push yourself, no one else is going to do it for you.",
      "The pain you feel today will be the strength you feel tomorrow.",
      "Small daily improvements lead to stunning results.",
      "Success is not for the lazy."
    ];

    const quoteBox = document.getElementById("quote");
    function showRandomQuote() {
      const quote = quotes[Math.floor(Math.random() * quotes.length)];
      quoteBox.innerText = `"${quote}"`;
    }

    showRandomQuote();
    setInterval(showRandomQuote, 10000); // change quote every 10s
    updateProgressReport();

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</body>
</html>
